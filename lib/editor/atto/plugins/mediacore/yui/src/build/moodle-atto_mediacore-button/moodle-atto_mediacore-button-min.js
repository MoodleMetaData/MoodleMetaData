YUI.add("moodle-atto_mediacore-button",function(e,t){e.namespace("M.atto_mediacore").Button=e.Base.create("button",e.M.editor_atto.EditorPlugin,[],{_chooser:null,initializer:function(){if(this.get("disabled"))return;if(!this.get("chooser_js_url")||!this.get("url")||!this.get("mode")){var e=M.util.get_string("noparamserror","atto_mediacore");throw new Error(e)}this._loadScript(this.get("chooser_js_url")),this.addButton({icon:"icon",iconComponent:"atto_mediacore",callback:this._initChooser})},_initChooser:function(){if(!mediacore){var t=M.util.get_string("nochooserjserror","atto_mediacore");throw new Error(t)}if(!this._chooser){var n={url:this.get("url"),mode:this.get("mode")};this._chooser=mediacore.chooser.init(n),this._chooser.on("media",e.bind(this._insertContent,this)),this._chooser.on("error",function(e){throw e})}this._chooser.open()},_insertContent:function(t){console.log("insertContent",t,this);var n=e.Node.create("<a></a>").setAttrs({href:t.embed_url,"data-media-id":t.id}),r=e.Node.create("<img/>").setAttrs({src:t.thumb_url,width:"400",height:"225",alt:t.title,title:t.title});n.appendChild(r),this.editor.focus();var i=n.getDOMNode().outerHTML;this.get("host").insertContentAtFocusPoint(i),this.markUpdated()},_loadScript:function(e){var t=document.createElement("script");t.src=e,(document.body||document.head||document.documentElement).appendChild(t)}},{ATTRS:{disabled:{value:!1},chooser_js_url:{value:null},url:{value:null},mode:{value:"popup"}}})},"@VERSION@",{requires:["moodle-editor_atto-plugin"]});
